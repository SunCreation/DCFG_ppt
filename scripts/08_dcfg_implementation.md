# 슬라이드 8: D-CFG: 구현 방법\n\n**(슬라이드 전환 후 잠시 멈춤)**\n\n---\n\n### **슬라이드 소개 및 구현의 필요성 (0:00 ~ 0:30)**\n\n\"D-CFG의 개념은 이해했지만, 이산 데이터의 엄청난 조합을 어떻게 실제로 처리할 수 있을까요? 이 슬라이드에서는 D-CFG가 조합 폭발 문제를 회피하고 효율적으로 구현되는 두 가지 핵심 단계를 설명합니다.\"\n\n---\n\n### **1단계: 토큰별 분해 (0:30 ~ 1:15)**\n\n\"첫 번째 단계는 \'토큰별 분해\'입니다. 이산 확산 모델은 시퀀스 전체(길이 L)를 한 번에 생성하는 것이 아니라, 각 위치(ℓ)의 토큰을 독립적으로 또는 이전 토큰에 의존하여 순차적으로 생성하거나 마스킹된 토큰을 복원하는 방식으로 작동합니다. D-CFG는 이 특성을 활용하여, 시퀀스 전체의 확률을 계산하는 대신 각 위치의 토큰 확률을 개별적으로 계산합니다.\n\n슬라이드 왼쪽 상단의 수식처럼, 전체 시퀀스 확률을 각 토큰 위치에서의 확률의 곱으로 분해하여 계산합니다. 이렇게 하면 N의 L제곱이라는 전체 시퀀스 조합을 고려할 필요 없이, 각 위치에서 어휘 크기 N만큼의 가능한 토큰들만 고려하면 됩니다. 이 덕분에 계산 복잡도가 O(N^L)에서 O(L×N)으로 대폭 감소하게 됩니다. 이는 실제 적용 가능한 수준으로 계산량을 줄이는 결정적인 아이디어입니다.\"\n\n---\n\n### **2단계: 확률 계산 및 정규화 (1:15 ~ 1:50)**\n\n\"두 번째 단계는 \'확률 계산 및 정규화\'입니다. 각 위치 ℓ에서, 우리는 어휘에 있는 모든 가능한 토큰 z\'에 대해 조건부 모델 p\_θ(z\' | y, z\_t)와 무조건부 모델 p\_θ(z\' | z\_t)로부터 확률 값을 얻습니다. 그리고 이 두 확률을 가이던스 강도 γ를 사용하여 가중 조합하여 가이던스가 적용된 확률 p\_guided를 계산합니다.\n\n슬라이드 오른쪽의 의사 코드(pseudocode)가 이 과정을 보여줍니다. 각 위치와 각 후보 토큰에 대해 조건부 확률과 무조건부 확률을 얻고, 이를 γ로 조합한 후, 해당 위치의 모든 가능한 토큰에 대한 확률 합이 1이 되도록 최종적으로 정규화합니다. 이 정규화 과정도 각 위치별로 독립적으로 수행되므로 전체 시퀀스에 대한 복잡한 정규화 문제를 피할 수 있습니다.\"\n\n---\n\n### **마무리 및 다음 슬라이드 예고 (1:50 ~ 2:00)**\n\n\"이처럼 D-CFG는 토큰별 분해와 확률 직접 조작을 통해 이산 데이터에서도 효과적인 가이던스를 가능하게 합니다. 다음 장에서는 또 다른 이산 가이던스 방법인 D-CBG의 개념에 대해 알아보겠습니다. D-CBG는 외부 분류기를 활용하는 방식입니다.\"\n
